(this.webpackJsonpchatting_life=this.webpackJsonpchatting_life||[]).push([[0],{285:function(t,e,n){},287:function(t,e,n){},366:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),i=n(35),c=n.n(i),o=(n(285),n(3)),s=n(7),l=n(30),d=n(117),u=n(122),p=n(123),f=n(374),h=n(370),j=n(375),g=n(371),x=n(71),m=n(42),b=n(373),O=n(376),y=n(372),_=(n(287),n(288),n(19)),v=n(377),Y=n(378),M=n(1),D=f.a.Header,w=f.a.Content,k=f.a.Footer,A=["Friends","College classmates","Other classmates","Family","Teachers","Others"],S=250;var W=function(){function t(){return Object(M.jsxs)("div",{children:[Object(M.jsx)("img",{src:".chatting_life_logo.png",className:"logo",id:"loadingImg",alt:"Logo",style:{position:"absolute",top:"30%",left:"50%",transform:"translate(-50%,-50%)",height:"72px",opacity:(100-Math.abs(0))/100}}),Object(M.jsx)(h.a,{tip:"Loading data...",style:{position:"absolute",top:"55%",left:"50%",transform:"translate(-50%,-50%)",opacity:(100-Math.abs(0))/100}}),Object(M.jsx)(j.a,{percent:100,status:"active",style:{position:"absolute",top:"75%",left:"50%",transform:"translate(-50%,-50%)",width:"40%",opacity:(100-Math.abs(0))/100}})]})}function e(t){function e(t){var e=t.attr,n=e.x,a=e.y,r=e.msg,i=e.date,c=e.opacity;return Object(M.jsxs)("div",{className:"tooltip",style:{left:n-120-10,top:a-70-10,width:120,height:70,opacity:c,fontSize:12},children:["Date: ",i,Object(M.jsx)("br",{}),"Messages: ",r,Object(M.jsx)("br",{}),"Week: ",_(i,"YYYY-MM-DD").format("ddd")]})}function n(t){var e=t.attr,n=e.msg,a=e.date,r=e.opacity,i=t.xScale,c=t.yScale;return Object(M.jsx)("div",{style:{position:"relative",left:i(a)+g-6,top:c(n)-j-10,borderRadius:"5px",border:"white 2px solid",backgroundColor:"#91a8f9",width:10,height:10,opacity:r,transition:"opacity 0.5s",boxShadow:"2px 2px 2px grey",fontSize:12}})}var a=t.rangeByWeek,i=t.rangeByMonth,c=t.rangeByYear,d=t.weeks,u=t.conversations,p=t.filter_setDateRange,f=t.filter_dateRange,h=1500,j=200,g=25,x=Math.min((h-g)/a.length-1,j/5*3/7),m=r.a.useState({x:0,y:0,date:0,msg:0,opacity:0}),b=Object(o.a)(m,2),O=b[0],y=b[1],v=s.p().domain(I.map((function(t){return t.date}))).range([0,h-g]),Y=s.s().domain([0,h-g]).range(I.map((function(t){return t.date}))),D=s.r().domain([0,s.m(I,(function(t){return t.msg}))]).range([90,50]).exponent(.5),w=s.q().domain([0,s.m(I,(function(t){return t.msg}))]).range([j/5,0]),k=s.b().x((function(t){return v(t.date)})).y0(j/5).y1((function(t){return w(t.msg)})).curve(s.i)(I),A=s.p().domain(d).range([0,j/5*3]),S=s.s().domain([0,j/5*3]).range(d);return r.a.useEffect((function(){if(s.t("#heatmap").call(s.f().on("brush",(function(t){var e=t.selection,n=[];s.u(".heatRect").filter((function(t,a,r){try{return null!==r&&null!=a&&null!==r[a]&&+r[a].getAttribute("x")+x>=e[0][0]&&+r[a].getAttribute("x")<=e[1][0]&&+r[a].getAttribute("y")+x>=e[0][1]&&+r[a].getAttribute("y")<=e[1][1]&&(n.push(r[a].getAttribute("id")),!0)}catch(i){return!1}})).attr("fill",(function(t,e,n){var a=u[n[e].getAttribute("id")];return"hsl(262,68%,".concat(D(a),"%)")})),s.u(".heatRect").filter((function(t,n,a){try{return!(null!==a&&null!=n&&null!==a[n]&&+a[n].getAttribute("x")+x>=e[0][0]&&+a[n].getAttribute("x")<=e[1][0]&&+a[n].getAttribute("y")+x>=e[0][1]&&+a[n].getAttribute("y")<=e[1][1])}catch(r){return!0}})).attr("fill",(function(t,e,n){var a=u[n[e].getAttribute("id")];return"hsl(220,62%,".concat(D(a),"%)")})),JSON.stringify(n)!==JSON.stringify(f)&&setTimeout((function(){p(n)}),0)})).on("end",(function(t){var e=t.selection,n=[];s.u(".heatRect").filter((function(t,a,r){try{return null!==r&&null!=a&&null!==r[a]&&+r[a].getAttribute("x")+x>=e[0][0]&&+r[a].getAttribute("x")<=e[1][0]&&+r[a].getAttribute("y")+x>=e[0][1]&&+r[a].getAttribute("y")<=e[1][1]&&(n.push(r[a].getAttribute("id")),!0)}catch(i){return!1}})),0===n.length&&(setTimeout((function(){p(null)}),0),s.t("#area_mask").remove())}))),null!==f){var t=f.map((function(t){return _(t,"YYYY-MM-DD")})),e=s.b().x((function(t){return v(t.date)})).y0(j/5).y1((function(e){return _(e.date,"YYYY-MM-DD").isBetween(_.min(t),_.max(t))?w(e.msg):j/5})).curve(s.i)(I);s.t("#area_mask").remove(),s.t("#group_area").append("path").attr("d",e).attr("fill","#8c5ae0").attr("id","area_mask")}})),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("svg",{width:h+x/2,height:j,children:[Object(M.jsxs)("g",{transform:"translate(".concat(g,",",0,")"),id:"group_area",onMouseMove:function(t){y({x:t.pageX,y:t.pageY,date:Y(t.pageX-(window.innerWidth-h)/2),msg:u[Y(t.pageX-Math.max((window.innerWidth-h)/2,0))],opacity:1})},onMouseLeave:function(t){return y({x:t.pageX,y:t.pageY,date:0,msg:0,opacity:0})},children:[Object(M.jsx)("rect",{height:j/5,width:h-g+x/2,stroke:"black",strokeWidth:.5,fill:"white"}),Object(M.jsx)("path",{d:k,fill:"#84ABFC",id:"areaPath"}),i.map((function(t){var e=_(t).format("MMM"),n=_(t).format("YYYY-MM-DD");return Object(M.jsxs)("g",{id:i.indexOf(t),children:[Object(M.jsx)("text",{transform:"translate(".concat(v(n),",").concat(j/5+15,")"),fontSize:11,textAnchor:"middle",fontWeight:100,id:n+"text",children:e}),Object(M.jsx)("line",{transform:"translate(".concat(v(n),",").concat(j/5,")"),x1:0,x2:0,y1:0,y2:2,stroke:"black",strokeWidth:.5,id:n+"line"})]})})),c.map((function(t){var e=_(t).format("YYYY"),n=_(t).format("YYYY-MM-DD");return Object(M.jsx)("text",{transform:"translate(".concat(v(n),",").concat(j/5+30,")"),fontSize:11,textAnchor:"middle",fontWeight:100,id:n,children:e})}))]}),Object(M.jsxs)("g",{transform:"translate(".concat(g,",").concat(j/5*2,")"),children:[Object(M.jsx)("rect",{height:j/5*3,width:h-g+x/2,stroke:"black",strokeWidth:.5,fill:"white"}),Object(M.jsx)("g",{id:"heatmap",onMouseMove:function(t){var e=d.indexOf(S(t.pageY-214))+1,n=_(Y(t.pageX-(window.innerWidth-h)/2+x/3),"YYYY-MM-DD").day(e).add(1,"w").format("YYYY-MM-DD");y({x:t.pageX,y:t.pageY,date:n,msg:u[n],opacity:1})},onMouseLeave:function(t){return y({x:t.pageX,y:t.pageY,date:0,msg:0,opacity:0})},children:I.map((function(t){var e=_(t.date).format("ddd"),n=_(l.a.floor(_(t.date).toDate())).format("YYYY-MM-DD"),a=_(t.date).format("YYYY-MM-DD");return Object(M.jsx)("rect",{width:x,height:x,className:"heatRect",fill:null!==f&&f.includes(t.date)?"hsl(262,68%,".concat(D(t.msg),"%)"):"hsl(220,62%,".concat(D(t.msg),"%)"),x:void 0===v(n)?-100:v(n)-x/3,y:A(e)+2,id:a})}))}),d.map((function(t){return Object(M.jsx)("text",{transform:"translate(-4,".concat(A(t)+10,")"),fontSize:11,textAnchor:"end",fontWeight:100,id:t,children:t})}))]})]}),Object(M.jsx)(e,{attr:O}),Object(M.jsx)(n,{attr:O,xScale:v,yScale:w})]})}function n(t){var e=t.filter_setGroup,n=t.filter_group,a=t.filter_dateRange,i=t.message_tree,c=t.filter_app,o=Math.min(450,250)/2,l={},d=0;return Object.keys(i).forEach((function(t){"count"===t||null!==a&&!a.includes(t)||Object.keys(i[t]).forEach((function(e){"count"===e||null!==c&&c!==e||Object.keys(i[t][e]).forEach((function(n){"count"!==n&&(void 0===l[n]?l[n]=i[t][e][n].count:l[n]+=i[t][e][n].count,d+=i[t][e][n].count)}))}))})),r.a.useEffect((function(){var t=["#6e9dfc","#83cacb","#86cb79","#f1d754","#d9697b","#a175e6"],a=s.n().padAngle(.2).sortValues(null).sort(null),r=s.a().innerRadius(o-40).outerRadius(o-20).padRadius(10),i=s.t("#group_svg_g"),c=A,u=a(c.map((function(t){return l[t]})));i.selectAll("path").data(u).enter().append("path").attr("fill",(function(e,n){return t[n]})).attr("d",r).each((function(e,n){this._current=e;var a=i.append("g").attr("transform","translate(200,".concat(20*n-60,")"));a.append("rect").attr("width",15).attr("height",15).attr("fill",t[n]),a.append("text").attr("transform","translate(20,9)").attr("font-size",12).attr("font-weight",150).text(c[+n])})).on("mousemove",(function(t,e){s.t(".group_tooltip").remove(),s.t("#group_tooltip").append("div").style("position","fixed").style("left","".concat(t.pageX+20,"px")).style("top","".concat(t.pageY+20,"px")).style("padding","10px").attr("class","group_tooltip").html(c[e.index]+"<br/>"+e.data?"".concat(e.data," messages,\n                        ").concat(Math.round(e.data/d*1e4)/100,"%"):"No message")})).on("mouseout",(function(t){s.t(".group_tooltip").remove()})).on("click",(function(t,n){e(c[n.index])}));s.t("#group_background").on("click",(function(){e(null)})),i.selectAll("path").data(u).transition().delay(0).duration(750).attrTween("d",(function(t){var e=s.k(this._current,t);return this._current=e(0),function(t){return r(e(t))}})).attr("fill",(function(e,a){return null===n||n===c[a]?t[a]:"lightgrey"})),i.selectAll("rect").transition().delay(0).duration(750).attr("fill",(function(e,a){return null===n||n===c[a]?t[a]:"lightgrey"})),s.t("#group_svg .central_text text").empty()&&s.t("#group_svg .central_text").append("text").text("Total Message").attr("transform","translate(0,-5)").attr("font-size",12).attr("font-weight",180).attr("text-anchor","middle");var p=s.t("#group_svg .central_text #text_count");p.empty()&&s.t("#group_svg .central_text").append("text").attr("id","text_count").attr("font-size",32).attr("font-weight",300).attr("transform","translate(0,45)").attr("text-anchor","middle").text("0"),p=s.t("#group_svg .central_text #text_count");var f=+document.getElementById("text_count").innerHTML.replace(",","");p.transition().duration(750).tween("text",(function(){var t=s.l(f,d);return function(e){this.innerHTML=s.j(",")(Math.round(t(e)))}}))})),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{id:"group_tooltip"}),Object(M.jsxs)("svg",{width:450,height:250,id:"group_svg",children:[Object(M.jsx)("rect",{id:"group_background",width:450,height:250,fill:"#ffffff"}),Object(M.jsx)("g",{className:"group_svg",transform:"translate(".concat(o+10,",").concat(o,")")}),Object(M.jsx)("g",{id:"group_svg_g",transform:"translate(".concat(o,",").concat(o,")")}),Object(M.jsx)("g",{className:"central_text",transform:"translate(".concat(o,",").concat(.82*o,")")})]})]})}function a(t){var e=t.filter_app,n=t.filter_setApp,a=t.filter_dateRange,i=t.message_tree,c=(t.totalMsgApp,t.filter_group),o=t.filter_friend,l=250,d={Q:{send:0,receive:0},W:{send:0,receive:0}};return Object.keys(i).forEach((function(t){"count"===t||null!==a&&!a.includes(t)||Object.keys(i[t]).forEach((function(e){"count"!==e&&Object.keys(i[t][e]).forEach((function(n){"count"===n||null!==c&&c!==n||Object.keys(i[t][e][n]).forEach((function(a){"count"===a||null!==o&&o!==a||Object.keys(i[t][e][n][a]).forEach((function(r){"count"!==r&&Object.keys(i[t][e][n][a][r]).forEach((function(c){"count"!==c&&(void 0===d[e]&&(d[e]={}),void 0===d[e][c]?d[e][c]=i[t][e][n][a][r][c].count:d[e][c]+=i[t][e][n][a][r][c].count)}))}))}))}))}))})),r.a.useEffect((function(){var t=s.q().range([0,230]).domain([0,Math.max(d.Q.send+d.Q.receive,d.W.send+d.W.receive)]).nice(),a=s.d(s.q().range([230,10]).domain([0,Math.max(d.Q.send+d.Q.receive,d.W.send+d.W.receive)]).nice()).ticks(5);s.t("#app_QS").on("mousemove",(function(t,e){s.t(".app_tooltip").remove(),s.t("#app_tooltip").append("div").style("position","fixed").style("left","".concat(t.pageX+20,"px")).style("top","".concat(t.pageY+20,"px")).style("padding","10px").attr("class","app_tooltip").html("Total: ".concat(d.Q.send+d.Q.receive,"<br/>Send: ").concat(d.Q.send))})).on("mouseout",(function(t){s.t(".app_tooltip").remove()})).transition().duration(S).attr("x",37.5).attr("y",230-t(d.Q.send)).attr("width",37.5).attr("height",t(d.Q.send)).attr("fill",null===e||"Q"===e?"#84abfc":"lightgrey"),s.t("#app_QR").on("mousemove",(function(t,e){s.t(".app_tooltip").remove(),s.t("#app_tooltip").append("div").style("position","fixed").style("left","".concat(t.pageX+20,"px")).style("top","".concat(t.pageY+20,"px")).style("padding","10px").attr("class","app_tooltip").html("Total: ".concat(d.Q.send+d.Q.receive,"<br/>Receive: ").concat(d.Q.receive))})).on("mouseout",(function(t){s.t(".app_tooltip").remove()})).transition().duration(S).attr("x",37.5).attr("y",230-t(d.Q.receive)-t(d.Q.send)).attr("width",37.5).attr("height",t(d.Q.receive)).attr("fill",null===e||"Q"===e?"#6dc0c2":"lightgrey"),s.t("#app_WS").on("mousemove",(function(t,e){s.t(".app_tooltip").remove(),s.t("#app_tooltip").append("div").style("position","fixed").style("left","".concat(t.pageX+20,"px")).style("top","".concat(t.pageY+20,"px")).style("padding","10px").attr("class","app_tooltip").html("Total: ".concat(d.W.send+d.W.receive,"<br/>Send: ").concat(d.W.send))})).on("mouseout",(function(t){s.t(".app_tooltip").remove()})).transition().duration(S).attr("x",87.5).attr("y",230-t(d.W.send)).attr("width",37.5).attr("height",t(d.W.send)).attr("fill",null===e||"W"===e?"#84abfc":"lightgrey"),s.t("#app_WR").on("mousemove",(function(t,e){s.t(".app_tooltip").remove(),s.t("#app_tooltip").append("div").style("position","fixed").style("left","".concat(t.pageX+20,"px")).style("top","".concat(t.pageY+20,"px")).style("padding","10px").attr("class","app_tooltip").html("Total: ".concat(d.W.send+d.W.receive,"<br/>Receive: ").concat(d.W.receive))})).on("mouseout",(function(t){s.t(".app_tooltip").remove()})).transition().duration(S).attr("x",87.5).attr("y",230-t(d.W.receive)-t(d.W.send)).attr("width",37.5).attr("height",t(d.W.receive)).attr("fill",null===e||"W"===e?"#6dc0c2":"lightgrey"),s.t("#apps_yAxis").transition().duration(S).call(a),s.t("#app_qq").on("click",(function(){n("Q")})),s.t("#app_wechat").on("click",(function(){n("W")})),s.t("#apps_background").on("click",(function(){n(null)}))})),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("svg",{id:"apps",width:200,height:l,children:[Object(M.jsx)("rect",{id:"apps_background",width:200,height:l,fill:"white"}),Object(M.jsxs)("g",{id:"app_bar",transform:"translate(".concat(10,",",5,")"),children:[Object(M.jsx)("g",{id:"apps_yAxis",transform:"translate(".concat(37.5,",0)"),opacity:.8}),Object(M.jsxs)("g",{id:"app_qq",children:[Object(M.jsx)("rect",{x:"50",y:"0",width:l/6,height:"0.0",fill:"#6DC0C2",className:"app_rect",id:"app_QS"}),Object(M.jsx)("rect",{x:"50",y:"0",width:l/6,height:"0.0",fill:"#84ABFC",className:"app_rect",id:"app_QR"})]}),Object(M.jsxs)("g",{id:"app_wechat",children:[Object(M.jsx)("rect",{x:"100",y:"0",width:l/6,height:"0",fill:"#6DC0C2",className:"app_rect",id:"app_WS"}),Object(M.jsx)("rect",{x:"100",y:"0",width:"41.666666666666664",height:"0.0",fill:"#84ABFC",className:"app_rect",id:"app_WR"})]}),Object(M.jsx)("text",{x:104.5,y:240,fontSize:"11",fontWeight:"300",textAnchor:"middle",className:"app_rect",children:"WeChat"}),Object(M.jsx)("text",{x:52.5,y:240,fontSize:"11",fontWeight:"300",textAnchor:"middle",className:"app_rect",children:"QQ"}),Object(M.jsxs)("g",{id:"legend",transform:"translate(".concat(135,",").concat(125,")"),children:[Object(M.jsxs)("g",{id:"rev_leg",children:[Object(M.jsx)("rect",{width:10,height:10,fill:"#9cbec2"}),Object(M.jsx)("text",{fontSize:10,transform:"translate(20,10)",children:"Receive"})]}),Object(M.jsxs)("g",{id:"send_leg",transform:"translate(0,20)",children:[Object(M.jsx)("rect",{width:10,height:10,fill:"#99a6f6"}),Object(M.jsx)("text",{fontSize:10,transform:"translate(20,10)",children:"Send"})]})]})]})]}),Object(M.jsx)("div",{id:"app_tooltip"})]})}function i(t){var e=t.filter_friend,n=t.filter_setFriend,a=t.filter_dateRange,i=t.message_tree,c=(t.totalMsgApp,t.filter_group),o=t.filter_app,l=500,d=30,u=100,p=50,f=0,h={Friends:"#6e9dfc","College classmates":"#83cacb","Other classmates":"#86cb79",Family:"#f1d754",Teachers:"#d9697b",Others:"#a175e6"},j={},g={};function x(t){for(var e=0,n=0;n<t.length&&n<8;n++)e+=t.charCodeAt(n)*Math.pow(10,n);return e}Object.keys(i).forEach((function(t){"count"===t||null!==a&&!a.includes(t)||Object.keys(i[t]).forEach((function(e){"count"===e||null!==o&&o!==e||Object.keys(i[t][e]).forEach((function(n){"count"===n||null!==c&&c!==n||Object.keys(i[t][e][n]).forEach((function(a){"count"!==a&&(void 0===j[a]?j[a]=i[t][e][n][a].count:j[a]+=i[t][e][n][a].count,g[a]=n)}))}))}))}));var m=[];Object.keys(j).forEach((function(t){m.push([t,j[t]])})),m.sort((function(t,e){return-t[1]+e[1]}));var b=m.slice(0,15).filter((function(t){return""!==t[0]})).slice(0,10),O=b.map((function(t){return x(t[0])}));return r.a.useEffect((function(){var t=s.q().range([0,750-p-u]).domain([0,s.m(b,(function(t){return t[1]}))]).nice(),a=s.p().range([0,l-d-f]).domain(b.map((function(t){return t[0]}))),r=s.e(t),i=s.c(t).tickSizeInner(l-d-f).tickSizeOuter(0).tickFormat(s.j("")),c=s.t("#friends g").attr("transform","translate(0,".concat(d,")"));t.domain([0,s.m(b,(function(t){return t[1]}))]),a.domain(b.map((function(t){return t[0]}))),c.selectAll(".bar").each((function(){O.includes(x(s.t(this).attr("id").slice(4)))||s.t(this).transition().delay(0).remove().select("rect").transition().delay(0).duration(750).attr("width",650).attr("y",0).remove()})),b.forEach((function(r){if(c.select("#bar_"+x(r[0])).empty()){var i=c.append("g").attr("class","bar").attr("id","bar_"+x(r[0]));i.append("text").attr("font-size",12).attr("class","name").text(r[0]).attr("x",0).attr("y",l-d-f),i.append("text").attr("font-size",12).attr("class","count").text(0).attr("x",t(r[1])+10+u).attr("y",l-d-f),i.append("rect").data(r).attr("fill",e===g[r[0]]||null===e?h[g[r[0]]]:"lightgrey").attr("height",.8*a.bandwidth()).attr("width",t(r[1])).attr("x",u).attr("y",l-d-f)}var o=c.select("#bar_"+x(r[0])),p=o.select("rect"),j=o.select(".name"),m=o.select(".count");o.transition().delay(0).duration(750).attr("width",t(r[1])).attr("y",a(r[0])),p.on("click",(function(t,e){n(e)})).transition().delay(0).duration(750).attr("height",.8*a.bandwidth()).attr("width",t(r[1])).attr("y",a(r[0])).attr("fill",(function(t){return e===t||null===e?h[g[t]]:"lightgrey"})),j.transition().delay(0).duration(750).attr("y",a(r[0])+.5*a.bandwidth()),m.transition().delay(0).duration(750).tween("text",(function(){var t=s.l(+this.innerHTML,r[1]);return function(e){this.innerHTML=Math.round(t(e))}})).attr("y",a(r[0])+.5*a.bandwidth()).attr("x",t(r[1])+10+u)})),c.select(".xaxis").transition().duration(750).call(r),c.select(".xaxisBottom").transition().duration(750).call(i),s.t("#friends_bg").on("click",(function(){n(null)}))})),Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)("svg",{id:"friends",width:750,height:l,children:[Object(M.jsx)("rect",{id:"friends_bg",width:750,height:l,fill:"white"}),Object(M.jsxs)("g",{children:[Object(M.jsx)("g",{className:"xaxis",transform:"translate(".concat(u,",-10)")}),Object(M.jsx)("g",{className:"xaxisBottom",transform:"translate(".concat(u,",-10)"),opacity:.1}),Object(M.jsx)("g",{className:"yaxis"})]})]})})}function c(t){t.filter_dateRange;var e=t.filter_setDateRange,n=t.filter_group,a=t.filter_setGroup,i=t.filter_app,c=t.filter_setApp,l=t.filter_friend,d=t.filter_setFriend,u=(t.message_tree,t.totalMsgApp,t.friend_list),p=t.friend_group_list,f=g.a.useForm(),h=Object(o.a)(f,1)[0],j=r.a.useState(),y=Object(o.a)(j,2),D=y[0],w=y[1];function k(t){return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(g.a,{form:t.form,layout:"vertical",onValuesChange:function(t){var e=Object.keys(t)[0];"group"===e&&a("all"===t[e]?null:t[e]),"app"===e&&c("all"===t[e]?null:t[e]),"friend"===e&&d("all"===t[e]?null:t[e])},children:[Object(M.jsxs)(x.a,{gutter:16,children:[Object(M.jsx)(m.a,{span:14,children:Object(M.jsx)(g.a.Item,{name:"group",label:"Group",children:Object(M.jsxs)(b.a,{children:[Object(M.jsx)(b.a.Option,{value:"all",children:"All"},"all"),A.map((function(t){return Object(M.jsx)(b.a.Option,{value:t,children:t},t)}))]})})}),Object(M.jsx)(m.a,{span:10,children:Object(M.jsx)(g.a.Item,{name:"app",label:"App",children:Object(M.jsxs)(b.a,{children:[Object(M.jsx)(b.a.Option,{value:"all",children:"All"}),Object(M.jsx)(b.a.Option,{value:"W",children:"WeChat"}),Object(M.jsx)(b.a.Option,{value:"Q",children:"QQ"})]})})})]}),Object(M.jsx)(x.a,{gutter:16,children:Object(M.jsx)(m.a,{span:24,children:Object(M.jsx)(g.a.Item,{name:"friend",label:"Friend",children:Object(M.jsxs)(b.a,{showSearch:!0,children:[Object(M.jsx)(b.a.Option,{value:"all",children:"All"},"all"),A.includes(t.form.getFieldValue("group"))?p[t.form.getFieldValue("group")].map((function(t){return Object(M.jsx)(b.a.Option,{value:t,children:t},t)})):u.map((function(t){return Object(M.jsx)(b.a.Option,{value:t,children:t},t)}))]})})})}),Object(M.jsxs)(x.a,{gutter:16,children:[Object(M.jsx)(m.a,{span:12,children:Object(M.jsx)(g.a.Item,{name:"duration",label:"Duration",initialValue:"28",children:Object(M.jsxs)(b.a,{children:[Object(M.jsx)(b.a.Option,{value:"7",children:"7 days"}),Object(M.jsx)(b.a.Option,{value:"14",children:"14 days"}),Object(M.jsx)(b.a.Option,{value:"28",children:"28 days"}),Object(M.jsx)(b.a.Option,{value:"56",children:"56 days"}),Object(M.jsx)(b.a.Option,{value:"112",children:"112 days"})]})})}),Object(M.jsx)(m.a,{span:12,children:Object(M.jsx)(g.a.Item,{name:"step",label:"Step",initialValue:"1",children:Object(M.jsxs)(b.a,{children:[Object(M.jsx)(b.a.Option,{value:"1",children:"1 day"}),Object(M.jsx)(b.a.Option,{value:"2",children:"2 days"}),Object(M.jsx)(b.a.Option,{value:"3",children:"3 days"}),Object(M.jsx)(b.a.Option,{value:"4",children:"4 days"}),Object(M.jsx)(b.a.Option,{value:"5",children:"5 days"}),Object(M.jsx)(b.a.Option,{value:"6",children:"6 days"}),Object(M.jsx)(b.a.Option,{value:"7",children:"7 days"}),Object(M.jsx)(b.a.Option,{value:"14",children:"14 days"}),Object(M.jsx)(b.a.Option,{value:"28",children:"28 days"})]})})})]})]})})}return r.a.useEffect((function(){h.setFieldsValue({group:null===n?"all":n,app:null===i?"all":i,friend:null===l?"all":l})})),Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(x.a,{children:[Object(M.jsx)(m.a,{span:10,children:Object(M.jsx)(k,{form:h})}),Object(M.jsxs)(m.a,{span:14,children:[Object(M.jsx)(x.a,{children:Object(M.jsxs)(m.a,{span:24,style:{display:"flex",justifyContent:"space-around",alignItems:"center",padding:"50px 100px 0 100px"},children:[Object(M.jsx)(O.a,{type:"primary",shape:"circle",size:"large",icon:Object(M.jsx)(v.a,{}),onClick:function(){clearInterval(D);var t=_(F.toDate()),n=s.v.range(F.toDate(),t.add(+h.getFieldValue("duration"),"d").toDate());n=n.map((function(t){return _(t).format("YYYY-MM-DD")})),e(n),w(setInterval((function(){n=n.map((function(t){return _(t,"YYYY-MM-DD").add(+h.getFieldValue("step"),"d").format("YYYY-MM-DD")})),e(n),_(n[n.length-1],"YYYY-MM-DD").isAfter(R)&&clearInterval(D)}),750))}}),Object(M.jsx)(O.a,{shape:"circle",size:"large",icon:Object(M.jsx)(Y.a,{}),onClick:function(){clearInterval(D)}})]})}),Object(M.jsx)(x.a,{children:Object(M.jsx)(m.a,{span:24,style:{display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"50px "},children:Object(M.jsx)(O.a,{type:"link",onClick:function(){s.t("#heatmap").call(s.f().move,null),s.t("#area_mask").remove(),c(null),a(null),d(null),e(null),h.setFieldsValue({duration:"56",step:"28"})},children:"Clear Selection"})})})]})]})})}function W(t){var e=t.filter_dateRange,n=t.filter_group,a=t.filter_app,i=t.filter_friend,c=t.message_tree,o=(t.totalMsgApp,750),l=500,d=30,u=40,p=100,f=30,h=10,j=s.o(48).map((function(t){return 0})),g=s.o(48).map((function(t){return 0})),x=s.o(7).map((function(t){return 0})),m=s.o(7).map((function(t){return 0}));Object.keys(c).forEach((function(t){"count"===t||null!==e&&!e.includes(t)||Object.keys(c[t]).forEach((function(e){"count"===e||null!==a&&a!==e||Object.keys(c[t][e]).forEach((function(a){"count"===a||null!==n&&n!==a||Object.keys(c[t][e][a]).forEach((function(n){"count"===n||null!==i&&i!==n||Object.keys(c[t][e][a][n]).forEach((function(r){if("count"!==r){var i=void 0===c[t][e][a][n][r].send?0:c[t][e][a][n][r].send.count,o=void 0===c[t][e][a][n][r].receive?0:c[t][e][a][n][r].receive.count;j[r]+=i,g[r]+=o,x[(_(t,"YYYY-MM-DD").format("e")+6)%7]+=i,m[(_(t,"YYYY-MM-DD").format("e")+6)%7]+=o}}))}))}))}))}));var b=s.g(g,j,(function(t,e){return t+e})),O=s.g(x,m,(function(t,e){return t+e})),y=s.w.every(30).range(new Date(2e3,0,1),new Date(2e3,0,2)).map((function(t){return _(t).format("HH:mm")}));return r.a.useEffect((function(){var t=s.p().domain(y).range([0,o-u-p]).padding(.3),e=s.c(t).tickValues(t.domain().filter((function(t,e){return!(e%6)}))),n=s.q().domain([s.m(b),0]).range([250-d-u,0]).nice(),a=s.d(s.q().domain([0,s.m(b)]).range([250-d-u,0]).nice()).ticks(5),r=s.p().domain(N).range([0,o-u-p]).padding(.6),i=s.c(r),c=s.q().domain([s.m(O),0]).range([250-d-u,0]).nice(),l=s.d(s.q().domain([0,s.m(O)]).range([250-d-u,0]).nice()).ticks(5),h=s.t("#g_day #send"),_=s.t("#g_day #rev"),v=s.t("#g_week #send"),Y=s.t("#g_week #rev");h.selectAll("rect").data(j).enter().append("rect").attr("x",(function(e,n){return t(y[n])})).attr("y",(function(t){return 250-n(t)-f})).attr("width",t.bandwidth()).attr("height",(function(t){return n(t)})).attr("fill","#91a8f9"),h.selectAll("rect").transition().duration(S).attr("x",(function(e,n){return t(y[n])})).attr("y",(function(t){return 250-n(t)-f})).attr("width",t.bandwidth()).attr("height",(function(t){return n(t)})),_.selectAll("rect").data(g).enter().append("rect").attr("x",(function(e,n){return t(y[n])})).attr("y",(function(t,e){return 250-n(t)-f-n(j[e])})).attr("width",t.bandwidth()).attr("height",(function(t){return n(t)})).attr("fill","#8bbfc2"),_.selectAll("rect").transition().duration(S).attr("x",(function(e,n){return t(y[n])})).attr("y",(function(t,e){return 250-n(t)-f-n(j[e])})).attr("width",t.bandwidth()).attr("height",(function(t){return n(t)})),v.selectAll("rect").data(x).enter().append("rect").attr("x",(function(t,e){return r(N[e])})).attr("y",(function(t){return 250-c(t)-f})).attr("width",r.bandwidth()).attr("height",(function(t){return c(t)})).attr("fill","#91a8f9"),v.selectAll("rect").transition().duration(S).attr("x",(function(t,e){return r(N[e])})).attr("y",(function(t){return 250-c(t)-f})).attr("width",r.bandwidth()).attr("height",(function(t){return c(t)})),Y.selectAll("rect").data(m).enter().append("rect").attr("x",(function(t,e){return r(N[e])})).attr("y",(function(t,e){return 250-c(t)-f-c(x[e])})).attr("width",r.bandwidth()).attr("height",(function(t){return c(t)})).attr("fill","#8bbfc2"),Y.selectAll("rect").transition().duration(S).attr("x",(function(t,e){return r(N[e])})).attr("y",(function(t,e){return 250-c(t)-f-c(x[e])})).attr("width",r.bandwidth()).attr("height",(function(t){return c(t)})),s.t("#g_day #xaxis").call(e),s.t("#g_week #xaxis").call(i),s.t("#g_day #yaxis").transition().duration(S).call(a),s.t("#g_week #yaxis").transition().duration(S).call(l)})),Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)("svg",{width:o,height:l,children:[Object(M.jsxs)("g",{id:"g_day",transform:"translate(".concat(u,",",0,")"),children:[Object(M.jsx)("text",{transform:"translate(".concat(-u,",",15,")"),fontSize:13,children:"By day"}),Object(M.jsx)("g",{id:"send"}),Object(M.jsx)("g",{id:"rev"}),Object(M.jsx)("g",{id:"xaxis",transform:"translate(0,".concat(250-f,")")}),Object(M.jsx)("g",{id:"yaxis",transform:"translate(0,".concat(1.3*d,")")}),Object(M.jsxs)("g",{id:"legend",transform:"translate(".concat(o-p-u+10,",").concat(125,")"),children:[Object(M.jsxs)("g",{id:"send_leg",children:[Object(M.jsx)("rect",{width:h,height:h,fill:"#9cbec2"}),Object(M.jsx)("text",{fontSize:10,transform:"translate(20,10)",children:"Receive"})]}),Object(M.jsxs)("g",{id:"send_leg",transform:"translate(0,20)",children:[Object(M.jsx)("rect",{width:h,height:h,fill:"#99a6f6"}),Object(M.jsx)("text",{fontSize:10,transform:"translate(20,10)",children:"Send"})]})]})]}),Object(M.jsxs)("g",{id:"g_week",transform:"translate(".concat(u,",").concat(250,")"),children:[Object(M.jsx)("text",{transform:"translate(".concat(-u,",",15,")"),fontSize:13,children:"By week"}),Object(M.jsx)("g",{id:"send"}),Object(M.jsx)("g",{id:"rev"}),Object(M.jsx)("g",{id:"xaxis",transform:"translate(0,".concat(250-f,")")}),Object(M.jsx)("g",{id:"yaxis",transform:"translate(0,".concat(1.3*d,")")}),Object(M.jsxs)("g",{id:"legend",transform:"translate(".concat(o-p-u+10,",").concat(125,")"),children:[Object(M.jsxs)("g",{id:"send_leg",children:[Object(M.jsx)("rect",{width:h,height:h,fill:"#9cbec2"}),Object(M.jsx)("text",{fontSize:10,transform:"translate(20,10)",children:"Receive"})]}),Object(M.jsxs)("g",{id:"send_leg",transform:"translate(0,20)",children:[Object(M.jsx)("rect",{width:h,height:h,fill:"#99a6f6"}),Object(M.jsx)("text",{fontSize:10,transform:"translate(20,10)",children:"Send"})]})]})]})]})})}var E=function(t){var e=r.a.useState(null),n=Object(o.a)(e,2),a=n[0],i=n[1];return r.a.useEffect((function(){null===a&&s.h(t).then((function(t){t.forEach((function(t){t.is_send=+t.is_send,t.time=_(t.time,"x")})),i(t)}))})),a}(".data.csv");if(!E)return Object(M.jsx)(t,{});var F=_("2019-06-07","YYYY-MM-DD"),R=_.max(E.map((function(t){return t.time}))),Q=d.a.range(F.toDate(),R.toDate(),1),C=l.a.range(F.toDate(),R.toDate(),1),z=u.a.range(F.toDate(),R.toDate(),1),T=p.a.range(F.toDate(),R.toDate(),1),N=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],B={};Q.forEach((function(t){B[_(t).format("YYYY-MM-DD")]=0})),E.forEach((function(t){t.time.isBetween(F,R)&&(B[_(t.time).format("YYYY-MM-DD")]+=1)}));var I=[];Object.keys(B).forEach((function(t){return I.push({date:t,msg:B[t]})}));var q=[],V={},X={};E.forEach((function(t){void 0===X[t.time.format("YYYY-MM-DD")]?X[t.time.format("YYYY-MM-DD")]={count:1}:X[t.time.format("YYYY-MM-DD")].count+=1,void 0===X[t.time.format("YYYY-MM-DD")][t.app]?X[t.time.format("YYYY-MM-DD")][t.app]={count:1}:X[t.time.format("YYYY-MM-DD")][t.app].count+=1,void 0===X[t.time.format("YYYY-MM-DD")][t.app][t.group]?(X[t.time.format("YYYY-MM-DD")][t.app][t.group]={count:1},void 0===V[t.group]&&(V[t.group]=[])):X[t.time.format("YYYY-MM-DD")][t.app][t.group].count+=1,void 0===X[t.time.format("YYYY-MM-DD")][t.app][t.group][t.talker]?(X[t.time.format("YYYY-MM-DD")][t.app][t.group][t.talker]={count:1},q.includes(t.talker)||(q.push(t.talker),V[t.group].push(t.talker))):X[t.time.format("YYYY-MM-DD")][t.app][t.group][t.talker].count+=1,void 0===X[t.time.format("YYYY-MM-DD")][t.app][t.group][t.talker][2*t.time.hour()+(t.time.minute()<30)]?X[t.time.format("YYYY-MM-DD")][t.app][t.group][t.talker][2*t.time.hour()+(t.time.minute()<30)]={count:1}:X[t.time.format("YYYY-MM-DD")][t.app][t.group][t.talker][2*t.time.hour()+(t.time.minute()<30)].count+=1,void 0===X[t.time.format("YYYY-MM-DD")][t.app][t.group][t.talker][2*t.time.hour()+(t.time.minute()<30)][t.is_send?"send":"receive"]?X[t.time.format("YYYY-MM-DD")][t.app][t.group][t.talker][2*t.time.hour()+(t.time.minute()<30)][t.is_send?"send":"receive"]={count:1}:X[t.time.format("YYYY-MM-DD")][t.app][t.group][t.talker][2*t.time.hour()+(t.time.minute()<30)][t.is_send?"send":"receive"].count+=1}));var L={Q:0,W:0};function H(){var t=r.a.useState(null),s=Object(o.a)(t,2),l=s[0],d=s[1],u=r.a.useState(null),p=Object(o.a)(u,2),h=p[0],j=p[1],g=r.a.useState(null),b=Object(o.a)(g,2),O=b[0],_=b[1],v=r.a.useState(null),Y=Object(o.a)(v,2),A=Y[0],S=Y[1];return Object(M.jsxs)(f.a,{children:[Object(M.jsx)(D,{className:"header",children:Object(M.jsx)("img",{src:".chatting_life_logo.png",className:"logo",alt:"logo"})}),Object(M.jsx)(w,{className:"content",style:{width:"1600px"},children:Object(M.jsxs)(x.a,{gutter:[16,16],children:[Object(M.jsx)(m.a,{span:24,children:Object(M.jsxs)(y.a,{bordered:!1,children:[Object(M.jsx)("p",{children:"Total Message"}),Object(M.jsx)(e,{rangeByWeek:C,rangeByMonth:z,rangeByYear:T,weeks:N,conversations:B,filter_dateRange:l,filter_setDateRange:d})]})}),Object(M.jsxs)(m.a,{span:12,children:[Object(M.jsxs)(x.a,{gutter:[16,16],children:[Object(M.jsx)(m.a,{span:16,children:Object(M.jsxs)(y.a,{bordered:!1,children:[Object(M.jsx)("p",{children:"Groups"}),Object(M.jsx)(n,{filter_group:h,filter_setGroup:j,message_tree:X,filter_dateRange:l,filter_app:O})]})}),Object(M.jsx)(m.a,{span:8,children:Object(M.jsxs)(y.a,{bordered:!1,children:[Object(M.jsx)("p",{children:"Apps"}),Object(M.jsx)(a,{filter_app:O,filter_setApp:_,filter_dateRange:l,filter_group:h,message_tree:X,totalMsgApp:L,filter_friend:A})]})})]}),Object(M.jsx)("br",{}),Object(M.jsx)(x.a,{gutter:[16,16],children:Object(M.jsx)(m.a,{span:24,children:Object(M.jsxs)(y.a,{bordered:!1,children:[Object(M.jsx)("p",{children:"Top Friends"}),Object(M.jsx)(i,{filter_friend:A,filter_setFriend:S,filter_dateRange:l,filter_group:h,message_tree:X,totalMsgApp:L,filter_app:O})]})})})]}),Object(M.jsxs)(m.a,{span:12,children:[Object(M.jsx)(x.a,{gutter:[16,16],children:Object(M.jsx)(m.a,{span:24,children:Object(M.jsxs)(y.a,{bordered:!1,children:[Object(M.jsx)("p",{children:"Action Center"}),Object(M.jsx)(c,{filter_dateRange:l,filter_setDateRange:d,filter_group:h,filter_setGroup:j,filter_app:O,filter_setApp:_,filter_friend:A,filter_setFriend:S,message_tree:X,totalMsgApp:L,friend_list:q,friend_group_list:V})]})})}),Object(M.jsx)("br",{}),Object(M.jsx)(x.a,{gutter:[16,16],children:Object(M.jsx)(m.a,{span:24,children:Object(M.jsxs)(y.a,{bordered:!1,children:[Object(M.jsx)("p",{children:"Active Time"}),Object(M.jsx)(W,{filter_dateRange:l,filter_group:h,filter_app:O,filter_friend:A,message_tree:X,totalMsgApp:L})]})})})]})]})}),Object(M.jsx)(k,{children:Object(M.jsx)("div",{className:"footer",children:"@Harry Lee | DATS-SHU 235 Information Visualization Course Project"})})]})}return Object.keys(X).forEach((function(t){"count"!==t&&Object.keys(X[t]).forEach((function(e){"count"!==e&&(L[e]+=X[t][e].count)}))})),Object(M.jsx)(H,{})},E=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,379)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),a(t),r(t),i(t),c(t)}))};c.a.render(Object(M.jsx)(r.a.StrictMode,{children:Object(M.jsx)(W,{})}),document.getElementById("root")),E()}},[[366,1,2]]]);
//# sourceMappingURL=main.dd3a0e76.chunk.js.map